# $ useMemo $

- useMemo는 React에서 컴포넌트의 성능을 최적화하는 데 사용되는 Hook

- 함수의 결과를 메모이제이션하여 비용이 많이 드는 계산을 최적화하는데 사용

- 함수를 메모하는 useCallback과는 달리, useMemo는 함수의 결과 값을 메모

<br/>

`const memo = useMemo(calculateValue, dependencies);`

### <span style='color:orange'>calculateValue </span>

useMemo의 첫 번째 인수로 들어가는 calculateValue는 캐시 하려는 값을 계산하는 함수입니다.

이 함수는 순수 함수여야 하며, 인수를 받지 않아야 하고, 모든 유형의 값을 반환할 수 있어야 합니다.

### <span style='color:orange'>dependencies </span>

calculateValue에서 참조된 모든 값의 목록입니다.

이 값은 property, state, 컴포넌트 내부에서 직접 선언된 모든 변수와 함수가 포함됩니다.

React는 여기에 담겨 있는 종속성들을 이전 값과 비교하여 변화가 있는지 판단합니다.

### <span style='color:orange'> Returns </span>

첫 렌더링이라면 인자 없이 함수에서 계산된 값을 반환합니다.

그다음 렌더링부터는 저장되어 있던 값을 반환하거나 함수를 호출하여 새로 계산된 값을 반환합니다.

---

<br/>

### 동작원리

useMemo를 사용하면 React는 먼저 현재 종속성과 이전 종속성을 비교하여 종속성이 변경되었는지 확인
종속성이 변경되지 않았다면, React는 함수를 다시 실행하지 않고 이전에 메모한 값을 반환
변경되었다면, 함수를 실행하고 값을 새로 계산하고 메모합니다. 그다음, 이 메모된 값을 반환

React는 내부적으로 각 useMemo 훅에 대해 메모된 값을 저장하기 위해 메모이제이션 캐시를 사용
캐시는 메모된 값을 나타내는 키와 종속성을 나타내는 값이 있는 JavaScript 개체로 구현
구성 요소가 렌더링 될 때 React는 캐시를 확인하여 메모된 값이 주어진 종속성에 대해 이미 존재하는지 확인
메모된 값이 있으면 React는 함수를 다시 계산하지 않고 반환

---

### 참고사항

일반적으로 대부분의 계산은 매우 빠르기 때문에 useMemo를 사용하지 않아도 괜찮다
하지만 내용이 많은 배열을 필터링하거나, 수정하거나, 비용이 많이 드는 계산을 수행하는 경우에 데이터가 변경되지 않았다면, 계산을 다시 수행하지 않는 것이 좋다
따라서 useMemo를 사용하면 데이터가 변경되지 않았을 때 업데이트를 하지 않기 때문에, 리렌더링을 막아서 쓸데없는 성능 저하를 막을 수 있다

useMemo를 사용한다고 해서 첫 번째 렌더링을 더 빠르게 만들지 않는다
업데이트 시 불필요한 작업을 건너뛰는 데만 도움이 됩니다.

### 사용하면 좋은 경우

- useMemo에 넣는 계산이 눈에 띄게 느리고 종속성이 거의 변하지 않는 경우
- seMemo로 감싸진 컴포넌트에 props를 전달하는 경우
- useMemo를 사용한 값이 다른 Hook의 종속성으로 사용될 수 있는 경우

### 단점

- useMemo를 과하게 사용하면 코드의 복잡성이 증가해 가독성이 떨어질 수 있다
- 지나치게 많은 값을 메모하게 되면 메모리 사용량이 증가해서 성능이 오히려 저하될 수 있다
- 컴포넌트가 리렌더링될 때마다 실행되는 로직이나 사이드 이펙트에 사용되어서는 안된다